2023-10-20 09:45:47,432 INFO    MainThread:11429 [wandb_setup.py:_flush():76] Current SDK version is 0.15.12
2023-10-20 09:45:47,433 INFO    MainThread:11429 [wandb_setup.py:_flush():76] Configure stats pid to 11429
2023-10-20 09:45:47,433 INFO    MainThread:11429 [wandb_setup.py:_flush():76] Loading settings from /root/.config/wandb/settings
2023-10-20 09:45:47,433 INFO    MainThread:11429 [wandb_setup.py:_flush():76] Loading settings from /root/Otter/wandb/settings
2023-10-20 09:45:47,433 INFO    MainThread:11429 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2023-10-20 09:45:47,433 INFO    MainThread:11429 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-10-20 09:45:47,433 INFO    MainThread:11429 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'pipeline/train/instruction_following.py', 'program_abspath': '/root/Otter/pipeline/train/instruction_following.py', 'program': '/root/Otter/pipeline/train/instruction_following.py'}
2023-10-20 09:45:47,433 INFO    MainThread:11429 [wandb_init.py:_log_setup():528] Logging user logs to /root/Otter/wandb/run-20231020_094547-4tah5egj/logs/debug.log
2023-10-20 09:45:47,434 INFO    MainThread:11429 [wandb_init.py:_log_setup():529] Logging internal logs to /root/Otter/wandb/run-20231020_094547-4tah5egj/logs/debug-internal.log
2023-10-20 09:45:47,434 INFO    MainThread:11429 [wandb_init.py:init():568] calling init triggers
2023-10-20 09:45:47,434 INFO    MainThread:11429 [wandb_init.py:init():575] wandb.init called with sweep_config: {}
config: {'external_save_dir': 'OTTER-LLaMA7B-densecaption', 'run_name': 'OTTER-LLaMA7B-densecaption', 'model_name': 'flamingo', 'inst_format': 'llama2', 'past_mimicit_path': '', 'past_images_path': '', 'past_train_config_path': '', 'mimicit_path': '/root/Otter/mimicit_data/CGD/CGD_instructions.json', 'images_path': '/root/Otter/mimicit_data/CGD/CGD.json', 'train_config_path': '/root/Otter/mimicit_data/CGD/CGD_train.json', 'past_mimicit_ic_path': '', 'past_images_ic_path': '', 'past_train_config_ic_path': '', 'mimicit_ic_path': '', 'images_ic_path': '', 'train_config_ic_path': '', 'mimicit_text_path': '', 'train_config_text_path': '', 'past_mimicit_text_path': '', 'past_train_config_text_path': '', 'training_data_yaml': '', 'past_mimicit_vt_path': '', 'past_images_vt_path': '', 'mimicit_vt_path': '', 'images_vt_path': '', 'past_subset_ration': 1.0, 'gradient_checkpointing': False, 'offline': False, 'save_ckpt_each_epoch': False, 'num_epochs': 1, 'logging_steps': 100, 'batch_size': 2, 'train_num_samples': 70941, 'gradient_accumulation_steps': 1, 'save_steps_interval': -1, 'pretrained_model_name_or_path': '/root/flamingo-llama2-chat-7B-init/', 'trained_ckpt': None, 'seed': 42, 'learning_rate': 1e-05, 'lr_scheduler': 'cosine', 'warmup_steps': 177.36, 'warmup_steps_ratio': 0.01, 'weight_decay': 0.1, 'workers': 1, 'dist_url': 'env://', 'dist_backend': 'nccl', 'horovod': False, 'no_set_device_rank': False, 'mask_lm_head': False, 'max_seq_len': 2048, 'patch_image_size': 224, 'resample_frames': 32, 'save_hf_model': False, 'customized_config': None, 'task_name': '', 'report_to_wandb': True, 'wandb_project': 'otter-training', 'wandb_entity': 'sugi205', 'save_checkpoints_to_wandb': False, 'resume_from_checkpoint': False, 'delete_previous_checkpoint': False, 'local_rank': 0, 'rank': 0, 'world_size': 2, 'tokenizer': LlamaTokenizer(name_or_path='/root/Llama-2-7b-chat-hf', vocab_size=32000, model_max_length=1000000000000000019884624838656, is_fast=False, padding_side='right', truncation_side='right', special_tokens={'bos_token': AddedToken("<s>", rstrip=False, lstrip=False, single_word=False, normalized=False), 'eos_token': AddedToken("</s>", rstrip=False, lstrip=False, single_word=False, normalized=False), 'unk_token': AddedToken("<unk>", rstrip=False, lstrip=False, single_word=False, normalized=False), 'pad_token': '<PAD>', 'additional_special_tokens': ['<answer>']}, clean_up_tokenization_spaces=False), 'distributed_type': <DistributedType.MULTI_GPU: 'MULTI_GPU'>, 'task': 'pretrain'}
2023-10-20 09:45:47,434 INFO    MainThread:11429 [wandb_init.py:init():618] starting backend
2023-10-20 09:45:47,434 INFO    MainThread:11429 [wandb_init.py:init():622] setting up manager
2023-10-20 09:45:47,438 INFO    MainThread:11429 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2023-10-20 09:45:47,440 INFO    MainThread:11429 [wandb_init.py:init():628] backend started and connected
2023-10-20 09:45:47,448 INFO    MainThread:11429 [wandb_init.py:init():720] updated telemetry
2023-10-20 09:45:48,105 INFO    MainThread:11429 [wandb_init.py:init():753] communicating run to backend with 90.0 second timeout
2023-10-20 09:45:48,587 INFO    MainThread:11429 [wandb_run.py:_on_init():2220] communicating current version
2023-10-20 09:45:48,668 INFO    MainThread:11429 [wandb_run.py:_on_init():2229] got version response 
2023-10-20 09:45:48,668 INFO    MainThread:11429 [wandb_init.py:init():804] starting run threads in backend
2023-10-20 09:45:52,324 INFO    MainThread:11429 [wandb_run.py:_console_start():2199] atexit reg
2023-10-20 09:45:52,324 INFO    MainThread:11429 [wandb_run.py:_redirect():2054] redirect: wrap_raw
2023-10-20 09:45:52,325 INFO    MainThread:11429 [wandb_run.py:_redirect():2119] Wrapping output streams.
2023-10-20 09:45:52,325 INFO    MainThread:11429 [wandb_run.py:_redirect():2144] Redirects installed.
2023-10-20 09:45:52,326 INFO    MainThread:11429 [wandb_init.py:init():845] run started, returning control to user process
